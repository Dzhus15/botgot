#!/bin/bash

echo "üöÄ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –ù–ê–°–¢–†–û–ô–ö–ê –î–ï–ü–õ–û–Ø"
echo "=================================="

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
echo "üì¶ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏..."
pip install -q aiogram aiosqlite aiohttp

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ä–µ–¥—É
if [ "$REPLIT_DEPLOYMENT" = "1" ]; then
    echo "üåç –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ deployment —Å—Ä–µ–¥–∞"
    
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º PostgreSQL –¥—Ä–∞–π–≤–µ—Ä
    echo "üêò –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º PostgreSQL –¥—Ä–∞–π–≤–µ—Ä..."
    pip install -q asyncpg
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –º–∏–≥—Ä–∞—Ü–∏—é
    echo "üîÑ –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –º–∏–≥—Ä–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö..."
    python auto_migrate.py
    
    echo "‚úÖ –î–µ–ø–ª–æ–π –Ω–∞—Å—Ç—Ä–æ–µ–Ω —É—Å–ø–µ—à–Ω–æ!"
else
    echo "üè† –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ development —Å—Ä–µ–¥–∞"
    echo "‚ÑπÔ∏è  –ú–∏–≥—Ä–∞—Ü–∏—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø—Ä–∏ –¥–µ–ø–ª–æ–µ"
fi

echo "‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"